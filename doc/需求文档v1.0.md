# 遨游轨迹 HarmonyOS App 需求文档 V1.0

## 一、项目概述
- **项目名称**：遨游轨迹（属于 AiApplication 子项目）
- **版本**：V1.0
- **目标平台**：HarmonyOS 原生应用（ArkTS）
- **编写日期**：2026-01-24
- **编写人**：待定

## 二、项目背景
广西地区扫墓多在山上，山上杂草丛生，道路复杂，许多祖墓位置非常难找，墓地上基本没有清晰碑文，主要依赖长辈一代又一代的口述记忆来传承。随着年轻人大量外出打工，长期不在家，口口相传的记忆很容易中断，导致：
- 一些墓地逐渐无人能准确找到；
- 墓地中安葬的是谁、属于哪一支家族，后代记不清；
- 家族扫墓路径无人系统记录，下一代接手成本高。

因此需要开发一款**专门用于记录、管理和分享扫墓轨迹及墓地信息的 App**，帮助家庭、家族对扫墓路线、墓地位置、相关人物故事进行**系统化记录与代际传承**，降低记忆丢失风险，让祭祖文化更容易延续。

## 三、目标与范围
### 3.1 总体目标
- **目标一**：提供简单易用的扫墓轨迹记录工具，让普通用户能在山上实时记录行走路径（含海拔），并准确标记每个祖墓的位置。
- **目标二**：支持在每个墓地点发布图文记录（人物信息、故事、扫墓照片等），形成可持续沉淀的家族数字档案。
- **目标三**：支持将完整扫墓轨迹、墓地点信息，在家庭内部或公开分享，提高家族成员之间的参与感和互动性。

### 3.2 V1.0 项目范围（本期必须实现）
- **核心重点**：扫墓轨迹的创建与记录——**一条轨迹**仅包含**起点、终点**及中间若干**打卡点**；打卡点即每个墓地，可在打卡点添加图文；支持**暂停**与**继续**轨迹记录；含海拔记录、在地图上展示轨迹。
- 轨迹的基础查看与管理（列表、详情、重命名、删除、简单分享），支持公开和私有两种可见范围。
- 打卡点（墓地点）信息记录（打卡 + 图文记录），用于保存每个墓地的文字说明和照片。
- 账号登录（V1.0 仅鸿蒙授权登录），用于区分不同用户的轨迹数据。
> 说明：导航/巡航、复杂的家庭成员管理、管理员维护等功能作为后续版本（V2.0 及以后）扩展，不作为 V1.0 的必做范围。

## 四、角色与用户
### 4.1 典型角色（V1.0）
- **R1 注册用户 / 轨迹创建人**：使用 HarmonyOS App 登录后，创建和管理自己的扫墓轨迹与墓地点记录。
- **R2 查看者**：登录后可在首页查看所有公开轨迹列表，进入详情查看但不能编辑；或通过分享图片了解轨迹信息（只读）。

### 4.2 角色主要目标（V1.0）
- **注册用户 / 轨迹创建人**：在山上方便地记录扫墓路径、标记每个墓地点位置，并为其添加文字说明和照片，便于后代再次找到。
- **查看者**：在首页浏览所有公开轨迹，了解不同家族的扫墓路线和文化；或通过分享图片了解轨迹信息。
> 说明：家庭成员角色区分、管理员维护、权限细粒度管理等，放在 V2.0 以后再设计实现。

## 五、业务流程（概述）
### 5.1 扫墓轨迹创建与记录流程
1. 用户登录 App，进入“创建轨迹”。
2. 输入轨迹名称与简短介绍。
3. 到达山脚或扫墓出发位置后，**设置起点**，输入起点名称，开始记录轨迹（采集 GPS + 海拔）。
4. 行进过程中可**暂停**记录，再次点击**继续**后恢复记录。
5. 到达某一祖墓位置时，**设置打卡点**（即该墓地），输入打卡点名称（如“xx祖墓”）；在打卡点页面可立即添加图文介绍（人物信息、扫墓照片、故事等），并可选择是否发布、是否对家庭/公开可见。
6. 如需前往下一处墓地，继续行走并再次**设置打卡点**，重复步骤 5。
7. 完成所有扫墓点后，**设置终点**，输入终点名称，点击“结束轨迹”，生成完整扫墓轨迹。

### 5.2 轨迹查看与分享流程
1. 用户登录后进入首页，可查看所有公开轨迹列表（按时间排序）。
2. 用户可通过底部 Tab 切换到“我的轨迹”，查看自己创建的所有轨迹。
3. 选择某条轨迹，查看整条路线、起点、终点及中间各打卡点（墓地点）信息。
4. 轨迹创建人可以将轨迹设置为：公开 / 私有（家庭可见将在 V2.0 引入）；非创建人只能查看公开轨迹详情，不能编辑。
5. 生成用于分享的轨迹图片（包含标题、关键信息和轨迹示意），分享到微信等社交平台（V2.0 再支持二维码和链接形式）。

### 5.3 （预留）轨迹巡航与上山导航流程
> 该流程为后续版本预留，V1.0 可以只实现“在地图上展示已记录的轨迹线和墓地点标记”，不做实时导航。
1. 用户到达山脚或附近位置，打开某条轨迹详情。
2. 选择全程巡航或某一段巡航。
3. App 显示 2D/3D 地图，展示轨迹线和用户当前位置。
4. 用户沿轨迹行进，系统实时更新当前位置和距离下一墓地点的距离/方向，辅助找到墓地。

## 六、功能需求（FR）
> 说明：编号形式为 FR-模块-序号，例如 FR-TRK-001。

### 6.1 模块一：轨迹创建与记录
- **FR-TRK-001**：用户可以创建新的扫墓轨迹，需填写轨迹名称和简短介绍。
- **FR-TRK-002**：用户在地图上**设置起点**，需输入起点名称（如“山脚入口”），开始记录路径。
- **FR-TRK-003**：系统在记录轨迹时，持续采集 GPS 坐标和海拔信息，并在地图上实时绘制路径。
- **FR-TRK-004**：用户可**暂停**轨迹记录，再次**继续**后从暂停点恢复记录。
- **FR-TRK-005**：用户在到达某一墓地时，可**设置打卡点**（即该墓地点），输入打卡点名称（如“xx公墓”）；系统弹出打卡点详情页，用户可填写墓地点基本信息（如：姓氏、辈分、称呼、去世年代等，自定义字段可简化为备注）。
- **FR-TRK-006**：用户可在打卡点详情页上传多张图片（如墓地照片、合影、祭品等）并填写文字说明。
- **FR-TRK-007**：一条完整的扫墓轨迹包含**一条连续路径**：起点、若干打卡点（每个墓地）、终点；用户可添加多个打卡点，并可对打卡点进行删除和排序。
- **FR-TRK-008**：仅当用户**设置终点**并确认“结束轨迹”时，轨迹状态从“编辑中”变为“已完成”，对外可见。
- **FR-TRK-009**：地图支持 2D / 3D 模式切换，记录的轨迹在线上可显示海拔变化信息（如高度曲线或在点位详情中显示高度）。
- **FR-TRK-010**：若多个打卡点位置非常接近，可在地图上合并显示为一个名称，避免标点过多影响视图（V1 可简化为不合并，只显示全部点）。

### 6.2 模块二：轨迹管理与分享（V1.0 精简版）
- **FR-MNG-001**：首页（Tab1）提供“公开轨迹列表”，展示所有设置为公开的轨迹，按创建时间倒序排序，任何用户均可进入详情查看但不能编辑。
- **FR-MNG-002**：用户可以在“我的轨迹”（Tab2）中查看自己创建的所有轨迹列表，按创建时间、名称排序。
- **FR-MNG-003**：轨迹详情页展示整条轨迹概览（地图）和分段列表，每段终点的简要信息。
- **FR-MNG-004**：仅轨迹创建人可以在详情页编辑轨迹名称和描述（如“刘氏家族扫墓轨迹”）。
- **FR-MNG-005**：仅轨迹创建人可以删除自己创建的轨迹。
- **FR-MNG-006**：仅轨迹创建人可以生成分享图片（轨迹缩略图 + 标题 + 简要信息），用户可通过系统分享面板发送该图片（V2.0 再支持二维码和链接形式）。
- **FR-MNG-007**：仅轨迹创建人可以对起点、终点及各打卡点位置进行矫正（例如误点、GPS 漂移），通过地图拖动或重新定位的方式调整坐标。

### 6.3 模块三：打卡点（墓地点）图文记录（V1.0）
- **FR-CNT-001**：在查看轨迹详情时，轨迹创建人可以在每个打卡点（墓地点）发布图文记录。
- **FR-CNT-002**：每条图文记录至少包含文字内容，可选图片（多张）。
- **FR-CNT-003**：仅轨迹创建人可以编辑或删除自己在该打卡点下发布的图文记录；其他用户只能查看公开轨迹下的图文内容，不能编辑或删除。
> 说明：评论互动、家庭成员共同维护、置顶展示等互动增强能力放在 V2.0 以后再实现。

### 6.4 模块四：账号与基础能力（V1.0）
- **FR-ACC-001**：V1.0 用户仅通过鸿蒙授权登录 App（无手机验证码、无其他第三方登录）。
- **FR-ACC-002**：用户可查看并编辑个人基本信息（昵称、头像、所属家族等）。
> 说明：消息/通知能力（如有人在某墓地点新增图文、评论提醒等）以及轨迹搜索能力（按名称、姓氏、地区等）均作为 V2.0 以后再规划，V1.0 不实现。

### 6.5 模块五：补充功能（可按优先级规划）
- **FR-EXT-001**：收藏/关注轨迹功能，方便用户快速找到关心的轨迹。
- **FR-EXT-002**：离线地图或弱网优化，在山上信号不好时仍可继续记录轨迹（V1 可记录轨迹本地缓存，网络恢复后再上传）。
- **FR-EXT-003**：数据备份与导出（如导出为 GPX/KML 或图片），后续可用于其他地图工具。
- **FR-EXT-004**：简单的统计信息，如某条轨迹的总距离、爬升高度、访问次数等。

## 七、非功能需求（NFR）
- **NFR-001 性能**：在普通手机（近 3 年主流机型）上，轨迹记录界面运行流畅，地图缩放/拖动无明显卡顿；轨迹列表加载时间 ≤ 3 秒（正常网络环境）。
- **NFR-002 稳定性**：轨迹记录过程中如 App 意外退出或手机重启，重新进入时应尽量恢复本地缓存的轨迹数据，避免数据全部丢失。
- **NFR-003 安全性**：
  - 重要接口需进行身份校验与权限控制；
  - 家庭内部内容默认不对外公开；
  - 轨迹与墓地点数据需进行基本加密传输（HTTPS）。
- **NFR-004 隐私保护**：
  - 清晰提示用户轨迹和位置数据的用途与可见范围；
  - 用户可以随时删除自己的轨迹与内容（受协议约束）；
  - 遵守相关隐私政策与法律法规。
- **NFR-005 兼容性**：支持主流 HarmonyOS 手机设备，适配常见屏幕尺寸与分辨率。
- **NFR-006 易用性**：界面简洁，操作路径清晰，对不熟悉智能手机的中老年人也尽量友好（如大按钮、明显的文字提示等）。

## 八、接口与数据（概要）
> 具体字段可在详细设计阶段补充接口文档。

- **用户相关接口**：注册登录、获取用户信息、更新用户信息。
- **轨迹相关接口**：创建轨迹、设置起点/打卡点/终点、暂停/继续记录、上传轨迹点数据（含海拔）、查询单条轨迹详情、修改/删除轨迹、矫正起点/终点/打卡点、查询公开轨迹列表（按时间排序，仅返回可见范围为公开的数据）。
- **打卡点（墓地点）与内容接口**：新增/查询/删除打卡点图文（仅轨迹创建人可写），暂不支持评论与置顶。
- **家庭空间接口**：V2.0 以后再设计，V1.0 不实现。
- **分享与统计接口**：生成轨迹分享图片（用于外部分享），访问统计能力留待 V2.0 后续扩展。

## 九、验收标准（示例）
- 依据上述功能需求（FR-XXX）逐条编写测试用例，至少包括：
  - 轨迹创建与记录（起点、打卡点、终点）是否准确，暂停/继续是否正常，海拔数据是否正常采集；
  - 轨迹在 2D/3D 地图上的显示是否符合预期；
  - 轨迹分享后，不同权限用户看到的内容是否正确；
  - 家庭成员管理与评论互动是否符合权限要求（V2.0）；
  - 轨迹巡航时定位是否基本准确（允许合理 GPS 漂移）；
  - 弱网或无网情况下的记录与上传逻辑是否符合设计。

## 十、后续规划与补充
- 引入更智能的能力，如：
  - 自动识别墓碑文字（OCR），辅助录入人物信息；
  - AI 自动生成家族故事时间线或图谱（基于已有图文内容）。
- 提供 Web 管理后台，方便家族管理员在电脑端整理和导出资料。
- 支持多语言与更多地区的殡葬文化适配。
- 后续根据用户反馈不断迭代细化需求与体验。
